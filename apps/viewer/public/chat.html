<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZoneWise.AI - Chat | Florida Zoning Intelligence</title>
  <meta name="description" content="Ask about Florida zoning in any language â€” English, Hebrew, Spanish, Portuguese. 67 counties, 5,000+ districts.">
  <meta name="theme-color" content="#020617">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={theme:{extend:{fontFamily:{sans:['"Inter"','system-ui','sans-serif'],hebrew:['"Heebo"','"Inter"','sans-serif'],mono:['"JetBrains Mono"','monospace']}}}}</script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{overflow:hidden;background:#020617}
    @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
    @keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
    .loading-bar{background:linear-gradient(90deg,transparent,#059669,transparent);background-size:200% 100%;animation:shimmer 1.5s infinite}
    .msg-enter{animation:fadeUp .3s ease-out}
    [dir="rtl"]{font-family:'Heebo','Inter',system-ui,sans-serif}
    ::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:#1e293b;border-radius:3px}
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="text/babel">
const{useState,useRef,useEffect,useCallback}=React;
const API="https://zonewise-agents.onrender.com";

const LANG={
  en:{flag:"ğŸ‡ºğŸ‡¸",name:"English",dir:"ltr"},
  he:{flag:"ğŸ‡®ğŸ‡±",name:"×¢×‘×¨×™×ª",dir:"rtl"},
  es:{flag:"ğŸ‡ªğŸ‡¸",name:"EspaÃ±ol",dir:"ltr"},
  pt:{flag:"ğŸ‡§ğŸ‡·",name:"PortuguÃªs",dir:"ltr"},
  ht:{flag:"ğŸ‡­ğŸ‡¹",name:"KreyÃ²l",dir:"ltr"},
  fr:{flag:"ğŸ‡«ğŸ‡·",name:"FranÃ§ais",dir:"ltr"},
  ar:{flag:"ğŸ‡¸ğŸ‡¦",name:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",dir:"rtl"},
};

async function nlpProcess(msg,history){
  const sys=`You are the NLP engine for ZoneWise.AI, a Florida zoning intelligence platform. Understand queries in ANY language including Hebrew (×¢×‘×¨×™×ª), Spanish, Portuguese, Haitian Creole, French, Arabic. Extract structured data and handle conversational follow-ups.

FLORIDA: 67 counties, 369 jurisdictions. Common codes: RS-1, C-1, BU-1, RR-65, PUD, GU, RM.

RESPOND WITH ONLY THIS JSON (no markdown, no backticks):
{"detected_language":"en|he|es|pt|ht|fr|ar","intent":"LIST_DISTRICTS|DISTRICT_DETAIL|PARCEL_LOOKUP|COMPARISON|FEASIBILITY|COUNTY_STATS|GREETING|HELP|GENERAL","entities":{"jurisdiction":"","zoning_code":"","parcel_id":"","address":""},"resolved_query":"English version of query with context resolved","response_language":"match user language","is_followup":false}`;
  const msgs=history.slice(-8).map(h=>({role:h.role==="user"?"user":"assistant",content:h.content}));
  msgs.push({role:"user",content:msg});
  try{
    const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:500,system:sys,messages:msgs})});
    const d=await r.json();
    const t=d.content?.map(b=>b.text||"").join("")||"{}";
    return JSON.parse(t.replace(/```json|```/g,"").trim());
  }catch{
    const q=msg.toLowerCase();
    let intent="GENERAL";
    if(/setback|height|lot|density|far |×“×¨×™×©×•×ª|requisitos/.test(q))intent="DISTRICT_DETAIL";
    else if(/zones|districts|list|××–×•×¨|zonas|distritos/.test(q))intent="LIST_DISTRICTS";
    else if(/parcel|folio|×—×œ×§×”/.test(q))intent="PARCEL_LOOKUP";
    else if(/how many|statistic|×›××”|cuÃ¡ntos|quantos/.test(q))intent="COUNTY_STATS";
    else if(/hello|hi |hey|hola|bonjour|×©×œ×•×|××” × ×©××¢/.test(q))intent="GREETING";
    return{detected_language:"en",intent,entities:{},resolved_query:msg,response_language:"en",is_followup:false};
  }
}

async function formatResponse(backend,nlp,userMsg){
  const{response_language:lang,intent}=nlp;
  if(lang==="en"&&backend?.answer)return backend.answer;
  const langName=lang==="he"?"Hebrew (×¢×‘×¨×™×ª)":lang==="es"?"Spanish":lang==="pt"?"Portuguese":lang==="ht"?"Haitian Creole":lang==="fr"?"French":lang==="ar"?"Arabic":"the user's language";
  try{
    const prompt=intent==="GREETING"
      ?`Respond to this greeting in ${langName}. You are ZoneWise.AI, Florida's zoning intelligence platform covering 67 counties. Be warm, professional. For Hebrew, use natural modern Hebrew. User said: "${userMsg}"`
      :`Translate and format this zoning data into ${langName}. Keep zoning codes, numbers, addresses in English/Latin. Use markdown (## headers, **bold**, â€¢ bullets). For Hebrew/Arabic write naturally, the UI handles RTL.

Data:
${backend?.answer||"No data found."}

User asked: "${userMsg}"`;
    const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1000,messages:[{role:"user",content:prompt}]})});
    const d=await r.json();
    return d.content?.map(b=>b.text||"").join("")||backend?.answer||"Error";
  }catch{return backend?.answer||"Error processing response."}
}

function renderInline(s){return s.split(/(\*\*[^*]+\*\*)/).map((p,i)=>p.startsWith("**")&&p.endsWith("**")?<strong key={i} className="font-semibold text-[#e2e8f0]">{p.slice(2,-2)}</strong>:<span key={i}>{p}</span>)}

function Md({text}){
  if(!text)return null;
  const lines=text.split("\n"),els=[];let tR=[];
  for(let i=0;i<lines.length;i++){
    const l=lines[i];
    if(l.startsWith("## "))els.push(<h2 key={i} className="text-[15px] font-bold text-[#f1f5f9] mt-3 mb-1.5">{l.slice(3)}</h2>);
    else if(l.startsWith("### "))els.push(<h3 key={i} className="text-[13px] font-semibold text-[#cbd5e1] mt-2.5 mb-1 uppercase tracking-wide">{l.slice(4)}</h3>);
    else if(l.startsWith("|")&&l.endsWith("|")){
      if(l.includes("---|"))continue;
      tR.push(l.split("|").filter(Boolean).map(c=>c.trim()));
      if(i===lines.length-1||!lines[i+1]?.startsWith("|")){const rows=[...tR];tR=[];
        els.push(<div key={"t"+i} className="overflow-x-auto my-2 rounded-lg border border-[#334155]/60"><table className="w-full text-[12px]"><tbody>
          {rows.map((r,ri)=><tr key={ri} className={ri===0?"bg-[#1e293b]/80":ri%2?"bg-[#0f172a]/40":""}>
            {r.map((c,ci)=>ri===0?<th key={ci} className="text-left py-2 px-3 text-[#94a3b8] font-medium text-[10px] uppercase tracking-widest">{c}</th>
              :<td key={ci} className="py-1.5 px-3 text-[#cbd5e1] border-t border-[#1e293b]">{renderInline(c)}</td>)}
          </tr>)}</tbody></table></div>);
      }
    }else if(/^\s*[â€¢Â·\-]\s/.test(l))els.push(<div key={i} className="flex gap-2 ml-1 text-[#cbd5e1] text-[13px]"><span className="text-[#34d399] shrink-0">â–¸</span><span>{renderInline(l.replace(/^\s*[â€¢Â·\-]\s*/,""))}</span></div>);
    else if(l.startsWith("_")&&l.endsWith("_"))els.push(<p key={i} className="text-[11px] text-[#64748b] italic mt-2">{l.slice(1,-1)}</p>);
    else if(l.trim())els.push(<p key={i} className="text-[#cbd5e1] text-[13px] leading-relaxed">{renderInline(l)}</p>);
    else els.push(<div key={i} className="h-1.5"/>);
  }
  return <div className="space-y-0.5">{els}</div>;
}

function Msg({msg,onSug}){
  const isU=msg.role==="user";
  const dir=LANG[msg.language]?.dir||"ltr";
  return(
    <div className={`flex ${isU?"justify-end":"justify-start"} mb-5 msg-enter`}>
      {!isU&&<div className="w-7 h-7 rounded-lg bg-gradient-to-br from-[#059669] to-[#0d9488] flex items-center justify-center text-white text-[10px] font-bold mr-2.5 mt-1 shrink-0 shadow-md shadow-emerald-900/30">Z</div>}
      <div className={`max-w-[82%] ${isU?"bg-gradient-to-br from-[#065f46]/40 to-[#064e3b]/30 border-[#059669]/20 rounded-tr-md":"bg-[#1e293b]/50 border-[#334155]/40 rounded-tl-md"} border rounded-2xl px-4 py-3`}>
        {isU?<p className="text-[#e2e8f0] text-[13.5px]" dir="auto">{msg.content}</p>:<div>
          <div className="flex items-center gap-2 mb-2 flex-wrap">
            {msg.intent&&<span className="text-[9px] font-mono uppercase tracking-[.15em] px-2 py-[3px] rounded-md bg-[#059669]/15 text-[#34d399] border border-[#059669]/20">{msg.intent}</span>}
            {msg.language&&msg.language!=="en"&&<span className="text-[9px] px-2 py-[3px] rounded-md bg-[#0ea5e9]/10 text-[#38bdf8] border border-[#0ea5e9]/20">{LANG[msg.language]?.flag} {LANG[msg.language]?.name}</span>}
            {msg.nlpTime&&<span className="text-[9px] text-[#475569] ml-auto tabular-nums">{msg.nlpTime}ms</span>}
          </div>
          <div dir={dir} style={{textAlign:dir==="rtl"?"right":"left"}}><Md text={msg.content}/></div>
          {msg.citations?.length>0&&<div className="mt-3 pt-2 border-t border-[#334155]/50 flex flex-wrap gap-2">
            {msg.citations.map((c,i)=><a key={i} href={c.url} target="_blank" rel="noopener" className="inline-flex items-center gap-1 text-[11px] text-[#34d399] hover:text-[#6ee7b7] bg-[#059669]/8 px-2 py-1 rounded-md border border-[#059669]/15">
              <svg className="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>{c.title||c.source}
            </a>)}
          </div>}
          {msg.suggestions?.length>0&&<div className="flex flex-wrap gap-1.5 mt-3">
            {msg.suggestions.map((s,i)=><button key={i} onClick={()=>onSug?.(s)} className="text-[11px] px-3 py-1.5 rounded-lg bg-[#0f172a]/60 text-[#94a3b8] hover:text-[#34d399] hover:bg-[#059669]/10 border border-[#334155]/50 hover:border-[#059669]/30 transition-all cursor-pointer">{s}</button>)}
          </div>}
        </div>}
      </div>
    </div>
  );
}

function App(){
  const[msgs,setMsgs]=useState([]);
  const[input,setInput]=useState("");
  const[loading,setLoading]=useState(false);
  const[stats,setStats]=useState(null);
  const[status,setStatus]=useState("checking");
  const[lang,setLang]=useState(null);
  const[showDbg,setShowDbg]=useState(false);
  const[dbg,setDbg]=useState([]);
  const endRef=useRef(null);
  const inRef=useRef(null);

  useEffect(()=>{endRef.current?.scrollIntoView({behavior:"smooth"})},[msgs]);
  useEffect(()=>{
    (async()=>{try{
      const[h,s]=await Promise.all([fetch(API+"/health"),fetch(API+"/api/stats")]);
      const hd=await h.json();setStatus(hd.database==="connected"?"live":"degraded");
      if(s.ok)setStats(await s.json());
    }catch{setStatus("offline")}})();
  },[]);

  const addDbg=(step,data)=>setDbg(p=>[...p,{time:Date.now(),step,data}]);

  const send=useCallback(async(text)=>{
    const q=text||input.trim();if(!q||loading)return;
    setInput("");setMsgs(p=>[...p,{role:"user",content:q}]);setLoading(true);setDbg([]);
    const t0=Date.now();
    try{
      addDbg("NLP","Processing...");
      const nlp=await nlpProcess(q,msgs);
      const nlpTime=Date.now()-t0;
      addDbg("NLP Result",JSON.stringify(nlp,null,2));
      if(nlp.detected_language!=="en")setLang(nlp.detected_language);

      if(nlp.intent==="GREETING"){
        const greeting=await formatResponse(null,nlp,q);
        const greetSuggestions={
          he:["×”×¨××” ×œ×™ ××–×•×¨×™ ×‘× ×™×™×” ×‘-Miami","×›××” ××—×•×–×•×ª ×™×© ×œ×›×?","××–×•×¨×™× ×‘-Satellite Beach"],
          es:["MuÃ©strame las zonas en Miami","Â¿CuÃ¡ntos distritos tienen?","Zonas en Orlando"],
          pt:["Mostre as zonas em Miami","Quantos distritos vocÃªs tÃªm?"],
        };
        setMsgs(p=>[...p,{role:"assistant",content:greeting,intent:"GREETING",language:nlp.detected_language,nlpTime,
          suggestions:greetSuggestions[nlp.detected_language]||["Show zones in Miami","How many districts?","Zones in Satellite Beach"]}]);
        setLoading(false);return;
      }

      addDbg("Backend",`Query: ${nlp.resolved_query}`);
      const br=await fetch(API+"/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:nlp.resolved_query||q,session_id:"nlp-"+Date.now()})});
      const bd=await br.json();
      addDbg("Backend",JSON.stringify({intent:bd.intent,entities:bd.entities},null,2));
      addDbg("Format",`Lang: ${nlp.response_language}`);
      const answer=await formatResponse(bd,nlp,q);
      const total=Date.now()-t0;
      setMsgs(p=>[...p,{role:"assistant",content:answer,intent:bd.intent||nlp.intent,language:nlp.detected_language,citations:bd.citations,suggestions:bd.suggestions||[],nlpTime:total}]);
    }catch(e){
      addDbg("Error",e.message);
      setMsgs(p=>[...p,{role:"assistant",content:`Connection error: ${e.message}. Backend may be cold-starting (~30s).`,intent:"ERROR"}]);
    }finally{setLoading(false);inRef.current?.focus();}
  },[input,loading,msgs]);

  const sc={live:{c:"bg-[#34d399]",t:"Live"},degraded:{c:"bg-[#fbbf24]",t:"Limited"},offline:{c:"bg-[#f87171]",t:"Offline"},checking:{c:"bg-[#64748b] animate-pulse",t:"..."}}[status];
  const isRTL=lang==="he"||lang==="ar";

  const starters=[
    {text:"Show zones in Satellite Beach",icon:"ğŸ–ï¸"},
    {text:"××” ××–×•×¨×™ ×”×‘× ×™×™×” ×‘-Miami?",icon:"ğŸ‡®ğŸ‡±"},
    {text:"Â¿CuÃ¡les son las zonas en Orlando?",icon:"ğŸ‡ªğŸ‡¸"},
    {text:"How many districts do you cover?",icon:"ğŸ“Š"},
    {text:"Look up parcel 29 3712-00-529",icon:"ğŸ“"},
    {text:"Quais sÃ£o as zonas em Tampa?",icon:"ğŸ‡§ğŸ‡·"},
  ];

  return(
    <div className="h-screen flex flex-col text-[#e2e8f0] overflow-hidden" style={{fontFamily:"'Inter',system-ui,sans-serif",background:"linear-gradient(180deg,#020617 0%,#0f172a 50%,#020617 100%)"}}>
      <header className="flex items-center justify-between px-5 py-3 border-b border-[#1e293b]/80 shrink-0" style={{background:"rgba(2,6,23,.9)",backdropFilter:"blur(12px)"}}>
        <div className="flex items-center gap-3">
          <div className="w-9 h-9 rounded-xl bg-gradient-to-br from-[#059669] to-[#0d9488] flex items-center justify-center shadow-lg shadow-emerald-900/40 relative">
            <span className="text-white font-bold text-sm">Z</span>
            <div className="absolute -top-0.5 -right-0.5 w-2.5 h-2.5 rounded-full bg-[#fbbf24] border-2 border-[#020617]"/>
          </div>
          <div>
            <div className="flex items-center gap-2"><h1 className="text-[15px] font-bold tracking-tight text-white">ZoneWise.AI</h1><span className="text-[9px] font-mono px-1.5 py-0.5 rounded bg-[#059669]/15 text-[#34d399] border border-[#059669]/20">NLP</span></div>
            <div className="flex items-center gap-2 mt-0.5">
              <p className="text-[10px] text-[#475569] tracking-wider uppercase">67 Counties Â· Multilingual</p>
              {lang&&lang!=="en"&&<span className="text-[10px] text-[#38bdf8]">{LANG[lang]?.flag} {LANG[lang]?.name}</span>}
            </div>
          </div>
        </div>
        <div className="flex items-center gap-3">
          <button onClick={()=>setShowDbg(!showDbg)} className={`text-[10px] px-2 py-1 rounded-md border transition-colors ${showDbg?"bg-[#059669]/15 border-[#059669]/30 text-[#34d399]":"border-[#334155]/50 text-[#475569] hover:text-[#94a3b8]"}`}>{showDbg?"â—‰ Debug":"â—‹ Debug"}</button>
          <div className="flex items-center gap-1.5 text-[11px] text-[#64748b]"><div className={`w-2 h-2 rounded-full ${sc.c}`}/><span>{sc.t}</span></div>
          <a href="/" className="text-[11px] text-[#475569] hover:text-[#94a3b8] transition-colors">â† Home</a>
        </div>
      </header>
      {loading&&<div className="h-[2px] loading-bar shrink-0"/>}

      <div className="flex-1 flex overflow-hidden">
        <div className="flex-1 flex flex-col min-w-0">
          <div className="flex-1 overflow-auto px-4 sm:px-6 py-5">
            {msgs.length===0&&(
              <div className="flex flex-col items-center justify-center h-full text-center max-w-xl mx-auto">
                <div className="w-20 h-20 rounded-2xl bg-gradient-to-br from-[#059669]/15 to-[#0d9488]/10 border border-[#059669]/15 flex items-center justify-center mb-6">
                  <svg className="w-10 h-10 text-[#34d399]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.2} d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/></svg>
                </div>
                <h2 className="text-xl font-bold text-white mb-2">Ask anything about Florida zoning</h2>
                <p className="text-[13px] text-[#64748b] mb-2">Natural language Â· Any language Â· Real data</p>
                <div className="flex gap-1.5 mb-8 flex-wrap justify-center">
                  {["ğŸ‡ºğŸ‡¸ English","ğŸ‡®ğŸ‡± ×¢×‘×¨×™×ª","ğŸ‡ªğŸ‡¸ EspaÃ±ol","ğŸ‡§ğŸ‡· PortuguÃªs","ğŸ‡­ğŸ‡¹ KreyÃ²l"].map((l,i)=><span key={i} className="text-[10px] px-2 py-1 rounded-md bg-[#1e293b]/50 text-[#64748b] border border-[#334155]/30">{l}</span>)}
                </div>
                <div className="grid grid-cols-2 gap-2.5 w-full">
                  {starters.map((q,i)=><button key={i} onClick={()=>send(q.text)} dir="auto" className="text-left text-[12.5px] px-3.5 py-3 rounded-xl bg-[#1e293b]/30 border border-[#334155]/30 text-[#94a3b8] hover:text-[#34d399] hover:bg-[#059669]/8 hover:border-[#059669]/20 transition-all flex items-start gap-2">
                    <span className="text-sm shrink-0 mt-0.5">{q.icon}</span><span>{q.text}</span>
                  </button>)}
                </div>
              </div>
            )}
            {msgs.map((m,i)=><Msg key={i} msg={m} onSug={send}/>)}
            {loading&&<div className="flex justify-start mb-4 msg-enter"><div className="w-7 h-7 rounded-lg bg-gradient-to-br from-[#059669] to-[#0d9488] flex items-center justify-center text-white text-[10px] font-bold mr-2.5 mt-1 shrink-0">Z</div><div className="bg-[#1e293b]/50 border border-[#334155]/40 rounded-2xl rounded-tl-md px-4 py-3"><div className="flex items-center gap-2 text-[11px] text-[#64748b]"><div className="flex gap-1"><div className="w-1.5 h-1.5 rounded-full bg-[#34d399]" style={{animation:"pulse .6s infinite"}}/><div className="w-1.5 h-1.5 rounded-full bg-[#34d399]" style={{animation:"pulse .6s .15s infinite"}}/><div className="w-1.5 h-1.5 rounded-full bg-[#34d399]" style={{animation:"pulse .6s .3s infinite"}}/></div><span>Analyzing...</span></div></div></div>}
            <div ref={endRef}/>
          </div>

          <div className="px-4 sm:px-6 pb-4 pt-2 shrink-0">
            <div className="flex gap-2 bg-[#0f172a]/80 border border-[#334155]/40 rounded-2xl px-4 py-2.5 focus-within:border-[#059669]/40 focus-within:shadow-[0_0_0_3px_rgba(5,150,105,.08)] transition-all">
              <input ref={inRef} value={input} onChange={e=>setInput(e.target.value)} onKeyDown={e=>e.key==="Enter"&&!e.shiftKey&&send()} dir={isRTL?"rtl":"ltr"}
                placeholder={isRTL?"...×©××œ ×¢×œ ××–×•×¨×™ ×‘× ×™×™×” ×‘×¤×œ×•×¨×™×“×”":"Ask in any language... English, ×¢×‘×¨×™×ª, EspaÃ±ol..."} className="flex-1 bg-transparent text-[#e2e8f0] placeholder-[#475569] outline-none text-[13px] py-1"/>
              <button onClick={()=>send()} disabled={loading||!input.trim()} className="px-4 py-1.5 rounded-xl bg-gradient-to-r from-[#059669] to-[#0d9488] text-white text-[12px] font-semibold disabled:opacity-20 transition-opacity shadow-md shadow-emerald-900/20">Send</button>
            </div>
            <div className="flex items-center justify-between mt-2 px-1">
              <p className="text-[10px] text-[#334155]">{stats?`${stats.zoning_districts?.toLocaleString()} districts Â· ${stats.zone_standards?.toLocaleString()} standards Â· ${stats.parcel_zones?.toLocaleString()} parcels`:"Loading..."}</p>
              <p className="text-[10px] text-[#334155]">NLP: Claude Sonnet Â· Data: Supabase</p>
            </div>
          </div>
        </div>

        {showDbg&&<div className="w-[340px] hidden lg:flex flex-col border-l border-[#1e293b]/80 bg-[#020617]/80">
          <div className="px-4 py-3 border-b border-[#1e293b]/60"><h3 className="text-[11px] font-semibold text-[#64748b] uppercase tracking-widest">NLP Pipeline</h3></div>
          <div className="flex-1 overflow-auto p-4">
            {dbg.length===0&&<p className="text-[11px] text-[#334155] text-center mt-8">Send a message to see the pipeline</p>}
            {dbg.map((l,i)=><div key={i} className="mb-3"><div className="flex items-center gap-2 mb-1"><span className="text-[9px] font-mono text-[#34d399] bg-[#059669]/10 px-1.5 py-0.5 rounded">{l.step}</span><span className="text-[9px] text-[#334155] tabular-nums">{l.time-dbg[0].time}ms</span></div><pre className="text-[10px] text-[#64748b] font-mono whitespace-pre-wrap break-all leading-relaxed">{l.data}</pre></div>)}
          </div>
        </div>}
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
